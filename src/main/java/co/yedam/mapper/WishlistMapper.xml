<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="co.yedam.mapper.WishlistMapper">

  <insert id="insert" parameterType="co.yedam.vo.WishlistVO">
    INSERT INTO list (user_id, pd_code)
    VALUES (#{userId}, #{pdCode})
  </insert>

  <delete id="delete" parameterType="co.yedam.vo.WishlistVO">
    DELETE FROM list
    WHERE user_id = #{userId} AND pd_code = #{pdCode}
  </delete>

  <select id="selectByUser" resultType="co.yedam.vo.WishlistVO">
    SELECT l.user_id, l.pd_code,
           p.pd_name AS pdName,
           p.pd_img AS pdImg,
           p.manufacturer,
           p.pd_price AS pdPrice
    FROM list l
    JOIN product p ON l.pd_code = p.pd_code
    WHERE l.user_id = #{userId}
  </select>

  <select id="exists" parameterType="co.yedam.vo.WishlistVO" resultType="boolean">
    SELECT CASE WHEN COUNT(*) > 0 THEN 1 ELSE 0 END
    FROM list
    WHERE user_id = #{userId} AND pd_code = #{pdCode}
  </select>
</mapper>

